# ===========================================
# üåç VARIABLES DE ENTORNO - FACTURACI√ìN AUT√ìNOMOS
# ===========================================

# üóÑÔ∏è DATABASE
DATABASE_URL="postgresql://postgres:${POSTGRES_PASSWORD:-secure_dev_pass}@localhost:5432/facturacion_dev"
POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-secure_dev_pass}

# üîê AUTHENTICATION & JWT - ‚ö†Ô∏è CR√çTICO PARA SEGURIDAD
# ‚ö†Ô∏è OBLIGATORIO: NO USAR VALORES POR DEFECTO EN PRODUCCI√ìN
# Genera con: openssl rand -base64 32
JWT_ACCESS_SECRET=your-super-secret-jwt-access-key-change-in-production-minimum-32-chars
JWT_REFRESH_SECRET=your-super-secret-jwt-refresh-key-change-in-production-minimum-32-chars
SESSION_SECRET=your-super-secret-session-key-change-in-production-minimum-32-chars

# Configuraci√≥n JWT adicional
JWT_ISSUER=facturacion-autonomos
JWT_AUDIENCE=facturacion-autonomos
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET=your_nextauth_secret_here_minimum_32_characters_long

# üìß EMAIL
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER="tu-email@gmail.com"
SMTP_PASS="tu-password-app"

# üèõÔ∏è AEAT API
AEAT_API_URL="https://prewww1.aeat.es/wlpl/TIKE-CONT/"
AEAT_NIF="12345678A"
AEAT_TEST_MODE=true

# üìú CERTIFICADOS DIGITALES - FIRMA XML
# ===========================================
# Configuraci√≥n para firma digital de facturas en formato XMLfacturae y e-invoice

# Opci√≥n 1: Certificado P12/PFX (recomendado para producci√≥n)
CERTIFICATE_PATH="/path/to/certificate.p12"
# ‚ö†Ô∏è MANTENER SECRETO EN PRODUCCI√ìN - Nunca comitear valores reales
CERTIFICATE_PASSWORD="certificate-password"

# Opci√≥n 2: Certificado en formato PEM separado (alternativa)
# Descomenta si usas archivos PEM en lugar de P12
# CERTIFICATE_PEM_PATH="/path/to/certificate.pem"
# PRIVATE_KEY_PEM_PATH="/path/to/private-key.pem"

# Control de firma XML
# Habilita/deshabilita la firma de XML autom√°tica
ENABLE_XML_SIGNING=true

# Validar certificado antes de usar
# Si est√° activado, verifica fechas de validez y formato
VALIDATE_CERTIFICATE=true

# Cache de certificados (en milisegundos)
# Reduce carga en carga/validaci√≥n repetida
CERTIFICATE_CACHE_TTL=3600000  # 1 hora

# ===========================================
# ‚è∞ TIMESTAMP SERVICE (RFC 3161)
# ===========================================
# Servicio de marcas de tiempo para cumplir normativa AEAT
# Automatiza la adici√≥n de timestamp a firmas digitales
# Requerido para validez legal de documentos firmados

# Habilita/deshabilita timestamping autom√°tico
ENABLE_XML_TIMESTAMP=true

# URL de la Autoridad de Timestamping (TSA)
# Principales TSAs p√∫blicas:
# - Certic√°mara: http://timestamp.certicamara.com:8080
# - Certum: http://time.certum.pl
# - GlobalSign: http://timestamp.globalsign.com
# - DigiCert: http://timestamp.digicert.com
# Para desarrollo, puede dejarse vac√≠o si ENABLE_TIMESTAMP_STUB=true
TSA_URL="http://timestamp.digicert.com"

# Timeout para peticiones a TSA (milisegundos)
TSA_TIMEOUT=30000

# Modo de desarrollo: TSA stub sin conexi√≥n real
# En desarrollo: true (usa timestamps simulados)
# En producci√≥n: false (requiere TSA_URL real)
ENABLE_TIMESTAMP_STUB=true

# Autenticaci√≥n TSA (si es requerida por el proveedor)
TSA_USERNAME=
TSA_PASSWORD=

# Reintentos en caso de fallo TSA (max 3)
TSA_RETRY_ATTEMPTS=3

# üîó WEBHOOK
WEBHOOK_SECRET="webhook-secret-super-seguro"

# ===========================================
# üí≥ STRIPE CONFIGURATION
# ===========================================
# Stripe API keys for payment processing
# Get these from: https://dashboard.stripe.com/apikeys
# ‚ö†Ô∏è NEVER commit real keys to version control

# Secret key for server-side API calls
STRIPE_SECRET_KEY=sk_test_51234567890abcdefghijklmnopqrstuvwxyz

# Webhook signing secret for verifying webhook signatures
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_1234567890abcdefghijklmnopqrstuvwxyz

# Publishable key for client-side (frontend) integration
STRIPE_PUBLISHABLE_KEY=pk_test_51234567890abcdefghijklmnopqrstuvwxyz

# Stripe API version (optional, defaults to account default)
STRIPE_API_VERSION=2023-10-16


# ===========================================
# üèõÔ∏è AEAT ADVANCED CONFIGURATION
# ===========================================
AEAT_CERTIFICATE_PATH=${CERTIFICATE_PATH}
AEAT_CERTIFICATE_PASSWORD=${CERTIFICATE_PASSWORD}
AEAT_RETRY_ATTEMPTS=3
AEAT_RETRY_DELAY=5000
AEAT_TIMEOUT=60000

# Enable/disable AEAT SII integration
# Set to true to enable automatic submission to AEAT SII
# Requires valid certificate and AEAT credentials
# Leave false for development/testing
AEAT_SII_ENABLED=false

# üåç ENVIRONMENT & PORTS
NODE_ENV="development"
PORT=3000

# üîß SERVICIOS DEL MONOREPO
AUTH_SERVICE_PORT=3003
INVOICE_SERVICE_PORT=3002
SUBSCRIPTION_SERVICE_PORT=3006
API_GATEWAY_PORT=3001
XML_TRANSFORMER_PORT=3004
WEB_PORT=5173

# üî¥ REDIS CONFIGURATION
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# üîÑ IDEMPOTENCY CONFIGURATION
IDEMPOTENCY_KEY_TTL_SECONDS=86400  # 24 horas
IDEMPOTENCY_CACHE_TTL_SECONDS=3600  # 1 hora en Redis
IDEMPOTENCY_ENABLED=true

# üç™ COOKIE CONFIGURATION
COOKIE_DOMAIN=localhost

# üåê CORS CONFIGURATION
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# üîó SERVICE URLs (for inter-service communication)
AUTH_SERVICE_URL=http://localhost:3003
INVOICE_SERVICE_URL=http://localhost:3002
SUBSCRIPTION_SERVICE_URL=http://localhost:3006
TAX_CALCULATOR_URL=http://localhost:3004
API_GATEWAY_URL=http://localhost:3001

# üé® FRONTEND CONFIGURATION
# URL base para peticiones API desde el navegador
# Importante: Incluir el sufijo /api para que el Gateway pueda rutear correctamente
# - Desarrollo local: http://localhost:3001/api
# - Docker Compose: http://api-gateway:3001/api
# - Producci√≥n: https://api.tuempresa.com/api
VITE_API_BASE_URL=http://localhost:3001/api
# Habilitar datos simulados (mock data) - no requiere conexi√≥n a la API
VITE_ENABLE_MOCK_DATA=false

# üìä ANALYTICS

# üîç LOGS
LOG_LEVEL="info"

# üöÄ FEATURES FLAGS
FEATURE_OCR_ENABLED=true
FEATURE_PEPPOL_ENABLED=false
FEATURE_ADVANCED_REPORTS=true

# üé® GRAFANA (para desarrollo)
GRAFANA_ADMIN_PASSWORD=admin_dev_password

# üìä MONITORING
LOG_LEVEL=debug
LOG_FORMAT=pretty
